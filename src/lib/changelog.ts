// 此文件由 scripts/convert-changelog.js 自动生成
// 请勿手动编辑

export interface ChangelogEntry {
  version: string;
  date: string;
  added: string[];
  changed: string[];
  fixed: string[];
}

export const changelog: ChangelogEntry[] = [
  {
    version: "4.3.5",
    date: "2025-08-29",
    added: [
      "新增Chromecast投屏功能：支持将视频内容投射到Chromecast设备",
      "Chromecast智能浏览器检测：仅在真正的Chrome浏览器中显示Chromecast按钮",
      "排除厂商浏览器显示Chromecast：自动识别并排除OPPO、小米、华为、三星等厂商浏览器"
    ],
    changed: [
      "优化弹幕控制按钮显示策略：只显示配置按钮，隐藏切换按钮和发射器以节省空间"
    ],
    fixed: [
      "修复小屏幕设备控制栏按钮被推出画面的问题：优化弹幕插件控制按钮占用空间",
      "修复移动端弹幕配置按钮不显示的问题：调整width参数确保移动端正确显示",
      "修复OPPO等厂商浏览器错误显示Chromecast按钮的问题：增加OppoBrowser和HeyTapBrowser识别"
    ]
  },
  {
    version: "4.3.4",
    date: "2025-08-28",
    added: [
      "新增弹幕数据智能缓存机制：支持localStorage持久化存储，30分钟缓存有效期",
      "缓存支持页面刷新保持：重新打开页面时自动复用缓存数据，避免重复请求",
      "智能缓存键生成：基于影片标题、年份、豆瓣ID、集数生成唯一缓存标识",
      "智能过期清理机制：每次缓存更新时自动清理过期数据，保持localStorage整洁"
    ],
    changed: [
      "优化切换集数时的弹幕加载逻辑：统一使用缓存优先策略，提升切换速度",
      "改进弹幕API调用性能：相同集数重复访问时直接使用缓存，减少服务器压力",
      "增强状态同步机制：弹幕缓存键使用最新state值而非ref值，确保数据一致性"
    ],
    fixed: [
      "修复切换集数时弹幕数据未清空的问题：现在使用正确的load()方法清空弹幕",
      "修复页面刷新后缓存失效的问题：改用localStorage替代内存缓存",
      "修复缓存键生成时机过早导致的缓存未命中问题",
      "修复ESLint编译错误：规范变量声明和Map迭代语法"
    ]
  },
  {
    version: "4.3.3",
    date: "2025-08-28",
    added: [
      "新增弹幕字号动态调整：支持小号(18px)、默认(25px)、大号(32px)、特大(40px)四种规格",
      "新增弹幕显示区域控制：支持1/4屏幕、1/2屏幕、3/4屏幕、全屏四种显示范围，避免遮挡重要画面",
      "新增弹幕速度调节：支持极慢(10秒)到极快(1秒)五档速度，满足不同观看习惯",
      "新增弹幕透明度设置：从完全透明(10%)到完全不透明(100%)五档透明度选择",
      "新增按类型蒙蔽功能：支持选择性隐藏滚动、顶部、底部弹幕，用户可根据喜好过滤弹幕类型",
      "新增弹幕防重叠开关：可开启/关闭弹幕重叠防护，优化密集弹幕显示效果",
      "新增完善的弹幕配置错误处理机制，防止设置调整时播放器崩溃"
    ],
    changed: [
      "优化外部弹幕开关性能：使用Promise.resolve()替代setTimeout()实现更好的异步处理",
      "改进弹幕显示区域配置：使用百分比值替代固定像素值，提升不同屏幕尺寸适配性",
      "增强状态同步机制：防止React状态更新和ArtPlayer插件状态不一致导致的显示问题",
      "所有弹幕设置均支持实时调整，无需刷新页面即可看到效果"
    ],
    fixed: [
      "修复外部弹幕开关按钮点击延迟和无响应问题，现在切换更加流畅",
      "修复关闭外部弹幕后仍显示弹幕的问题，现在会完全清空弹幕数据",
      "修复快速切换外部弹幕开关时的竞态条件问题，避免状态不一致",
      "修复弹幕显示区域调整无效的问题，现在可以正确控制弹幕显示范围",
      "恢复弹幕加载提示功能，现在会显示'已加载 X 条弹幕'或'暂无弹幕数据'"
    ]
  },
  {
    version: "4.3.2",
    date: "2025-08-27",
    added: [
    "集成第三方弹幕API功能，支持从多个视频平台获取弹幕数据",
    "新增caiji.cyou API集成，支持搜索真实视频内容而非预告片",
    "支持腾讯视频、爱奇艺、优酷、B站等主流平台弹幕获取",
    "智能内容匹配，自动过滤解说、预告等不相关内容",
    "支持多平台弹幕数据合并和时间排序"
    ],
    changed: [
    "优化弹幕API超时机制，爱奇艺30秒、优酷25秒、其他平台20秒",
    "改进弹幕数据格式转换，确保与ArtPlayer兼容",
    "移除不合适的测试弹幕fallback逻辑"
    ],
    fixed: [
    "修复弹幕API集数参数传递问题，现在切换集数时能正确获取对应集数的弹幕",
    "改进集数匹配逻辑，支持多种URL格式",
    "修复豆瓣链接解析只获取到预告片的问题",
    "添加定时任务用户处理调试信息，便于排查删除用户仍出现的问题"
    ]
  },
  {
    version: "4.3.1",
    date: "2025-08-27",
    added: [
    "新增用户自行注册功能",
    "注册页面支持用户名、密码验证",
    "管理员可配置是否允许用户注册",
    "注册成功后自动登录"
    ],
    changed: [
    "登录页面在数据库模式下显示注册链接",
    "增强用户名格式验证（3-20位字母数字下划线）",
    "密码长度要求至少6位"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "4.3.0",
    date: "2025-08-26",
    added: [
    "支持将 IPTV 频道添加到收藏中"
    ],
    changed: [
    "禁用 flv 直播，仅支持 m3u8 直播",
    "降低代理 ts 分片的内存占用"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "4.2.1",
    date: "2025-08-26",
    added: [
      // 无新增内容
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复直播源加载失败或离开页面后依然无限加载的问题"
    ]
  },
  {
    version: "4.2.0",
    date: "2025-08-26",
    added: [
    "支持 flv 直播和直播地址解析到 mp4 的处理",
    "增加直播台标的 proxy 以防止 cors",
    "支持播放页选集分组的滚动翻页"
    ],
    changed: [
    "管理后台页面的按钮增加加载中的 UI"
    ],
    fixed: [
    "/api/proxy/m3u8 仅对 m3u8 内容反序列化，降低内存和 CPU 消耗"
    ]
  },
  {
    version: "4.1.1",
    date: "2025-08-25",
    added: [
      // 无新增内容
    ],
    changed: [
    "增加对 url-tvg 和多 epg url 的支持"
    ],
    fixed: [
    "修复 epg 数据清洗中去重叠逻辑未考虑日期导致的问题"
    ]
  },
  {
    version: "4.1.0",
    date: "2025-08-24",
    added: [
    "解析 m3u 自带的 epg 和自定义 epg，增加今日节目单"
    ],
    changed: [
    "直播源数据刷新改为并发刷新"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "4.0.0",
    date: "2025-08-24",
    added: [
    "增加 iptv 订阅和播放功能"
    ],
    changed: [
    "搜索页面视频卡片移动端/右键菜单添加豆瓣链接",
    "搜索建议遵循色情过滤"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "3.2.1",
    date: "2025-08-22",
    added: [
      // 无新增内容
    ],
    changed: [
    "新增色色过滤分类",
    "调整搜索建议框层级"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "3.2.0",
    date: "2025-08-22",
    added: [
    "视频源管理支持批量启用、禁用、删除",
    "用户管理支持批量设置用户组",
    "视频卡片右键/长按菜单新增新标签页播放"
    ],
    changed: [
    "视频卡片移动端 hover 时仅保留播放按钮",
    "微调管理页面 UI 和视频卡片右键/长按菜单中的收藏样式"
    ],
    fixed: [
    "修复了搜索栏 enter 键自动选中第一个建议项的问题"
    ]
  },
  {
    version: "3.1.2",
    date: "2025-08-22",
    added: [
      // 无新增内容
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复移动端卡片无法点击的问题"
    ]
  },
  {
    version: "3.1.1",
    date: "2025-08-21",
    added: [
      // 无新增内容
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复了视频卡片 hover 的非播放按钮点击后进入播放页的问题"
    ]
  },
  {
    version: "3.1.0",
    date: "2025-08-21",
    added: [
    "增加用户组管理和用户组播放源限制",
    "增加管理面板视频源有效性检查",
    "搜索栏增加一键删除按钮"
    ],
    changed: [
    "放宽授权心跳对于网络问题的判断标准",
    "统一管理面板弹窗使用 createPortal",
    "VideoCard 允许移动端响应 hover 事件",
    "移动端布局 header 常驻，搜索按钮移动到 header 右侧",
    "调大搜索接口超时时间"
    ],
    fixed: [
    "修复 bangumi 返回的整数评分无小数导致 UI 不对齐的问题"
    ]
  },
  {
    version: "3.0.2",
    date: "2025-08-20",
    added: [
      // 无新增内容
    ],
    changed: [
    "优化机器码生成逻辑"
    ],
    fixed: [
    "修复 redis url 不支持 rediss 协议的问题"
    ]
  },
  {
    version: "3.0.1",
    date: "2025-08-20",
    added: [
      // 无新增内容
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复授权初始化错误"
    ]
  },
  {
    version: "3.0.0",
    date: "2025-08-20",
    added: [
    "防盗卖加固",
    "支持自定义用户可用视频源"
    ],
    changed: [
    "右键视频卡片可弹出操作菜单"
    ],
    fixed: [
    "过滤掉集数为 0 的搜索结果"
    ]
  },
  {
    version: "2.7.1",
    date: "2025-08-17",
    added: [
      // 无新增内容
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复 iOS 下版本面板可穿透滚动背景的问题"
    ]
  },
  {
    version: "2.7.0",
    date: "2025-08-17",
    added: [
    "视频卡片新增移动端操作面板，优化触控屏操作体验"
    ],
    changed: [
    "优化集数标题的匹配和展示逻辑"
    ],
    fixed: [
    "修复设置面板和修改密码面板背景可被拖动的问题"
    ]
  },
  {
    version: "2.6.0",
    date: "2025-08-17",
    added: [
    "新增搜索流式输出接口，并设置流式搜索为默认搜索接口，优化搜索体验",
    "新增源站搜索结果内存缓存，粒度为源站+关键词+页数，缓存 10 分钟",
    "新增豆瓣 CDN provided by @JohnsonRan"
    ],
    changed: [
    "搜索结果默认为无排序状态，不再默认按照年份排序",
    "常规搜索接口无结果时，不再设置响应的缓存头",
    "移除豆瓣数据源中的 cors-anywhere 方式"
    ],
    fixed: [
    "数据导出时导出站长密码，保证迁移到新账户时原站长用户可正常登录",
    "聚合卡片优化移动端源信息展示"
    ]
  },
  {
    version: "2.4.1",
    date: "2025-08-15",
    added: [
      // 无新增内容
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "对导入和 db 读取的配置文件做自检，防止 USERNAME 修改导致用户状态异常"
    ]
  },
  {
    version: "2.4.0",
    date: "2025-08-15",
    added: [
    "支持 kvrocks 存储（持久化 kv 存储）"
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复搜索结果排序不稳定的问题",
    "导入数据时同时更新内存缓存的管理员配置"
    ]
  },
  {
    version: "2.3.0",
    date: "2025-08-15",
    added: [
    "支持站长导入导出整站数据"
    ],
    changed: [
    "仅允许站长操作配置文件",
    "微调搜索结果过滤面板的移动端样式"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "2.2.1",
    date: "2025-08-14",
    added: [
      // 无新增内容
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复了筛选 panel 打开时滚动页面 panel 不跟随的问题"
    ]
  },
  {
    version: "2.2.0",
    date: "2025-08-14",
    added: [
    "搜索结果支持按播放源、标题和年份筛选，支持按年份排序",
    "搜索界面视频卡片展示年份信息，聚合卡片展示播放源"
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复 /api/search/resources 返回空的问题",
    "修复 upstash 实例无法编辑自定义分类的问题"
    ]
  },
  {
    version: "2.1.0",
    date: "2025-08-13",
    added: [
    "支持通过订阅获取配置文件"
    ],
    changed: [
    "微调部分文案和 UI",
    "删除部分无用代码"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "2.0.1",
    date: "2025-08-13",
    added: [
      // 无新增内容
    ],
    changed: [
    "版本检查和变更日志请求 Github"
    ],
    fixed: [
    "微调管理面板样式"
    ]
  },
  {
    version: "2.0.0",
    date: "2025-08-13",
    added: [
    "支持配置文件在线配置和编辑",
    "搜索页搜索框实时联想",
    "去除对 localstorage 模式的支持"
    ],
    changed: [
    "播放记录删除按钮改为垃圾桶图标以消除歧义"
    ],
    fixed: [
    "限制设置面板的最大长度，防止超出视口"
    ]
  },
  {
    version: "1.1.1",
    date: "2025-08-12",
    added: [
      // 无新增内容
    ],
    changed: [
    "修正 zwei 提供的 cors proxy 地址",
    "移除废弃代码"
    ],
    fixed: [
    "[运维] docker workflow release 日期使用东八区日期"
    ]
  },
  {
    version: "1.1.0",
    date: "2025-08-12",
    added: [
    "每日新番放送功能，展示每日新番放送的番剧"
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复远程 CHANGELOG 无法提取变更内容的问题"
    ]
  },
  {
    version: "1.0.5",
    date: "2025-08-12",
    added: [
      // 无新增内容
    ],
    changed: [
    "实现基于 Git 标签的自动 Release 工作流"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "1.0.4",
    date: "2025-08-11",
    added: [
    "优化版本管理工作流，实现单点修改"
    ],
    changed: [
    "版本号现在从 CHANGELOG 自动提取，无需手动维护 VERSION.txt"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "1.0.3",
    date: "2025-08-11",
    added: [
      // 无新增内容
    ],
    changed: [
    "升级播放器 Artplayer 至版本 5.2.5"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "1.0.2",
    date: "2025-08-11",
    added: [
      // 无新增内容
    ],
    changed: [
    "版本号比较机制恢复为数字比较，仅当最新版本大于本地版本时才认为有更新",
    "[运维] 自动替换 version.ts 中的版本号为 VERSION.txt 中的版本号"
    ],
    fixed: [
      // 无修复内容
    ]
  },
  {
    version: "1.0.1",
    date: "2025-08-11",
    added: [
      // 无新增内容
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
    "修复版本检查功能，只要与最新版本号不一致即认为有更新"
    ]
  },
  {
    version: "1.0.0",
    date: "2025-08-10",
    added: [
    "基于 Semantic Versioning 的版本号机制",
    "版本信息面板，展示本地变更日志和远程更新日志"
    ],
    changed: [
      // 无变更内容
    ],
    fixed: [
      // 无修复内容
    ]
  }
];

export default changelog;
